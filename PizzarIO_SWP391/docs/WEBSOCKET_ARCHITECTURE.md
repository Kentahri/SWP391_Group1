# KIáº¾N TRÃšC Há»† THá»NG PIZZARIO - TÃCH Há»¢P WEBSOCKET

## ğŸ“‹ KIáº¾N TRÃšC HIá»†N Táº I (TrÆ°á»›c khi thÃªm WebSocket)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          CLIENT LAYER (Browser)                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Thymeleaf Templates                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Guest   â”‚  â”‚ Cashier  â”‚  â”‚ Kitchen  â”‚  â”‚ Manager  â”‚  â”‚  Admin   â”‚    â”‚
â”‚  â”‚  Page    â”‚  â”‚  Page    â”‚  â”‚  Page    â”‚  â”‚  Page    â”‚  â”‚  Page    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚             â”‚             â”‚             â”‚             â”‚
         â”‚ HTTP/HTTPS  â”‚             â”‚             â”‚             â”‚
         â”‚ Request     â”‚             â”‚             â”‚             â”‚
         â–¼             â–¼             â–¼             â–¼             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       SPRING BOOT APPLICATION                               â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                      SECURITY LAYER                                    â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚
â”‚  â”‚  â”‚  Spring Security (Authentication & Authorization)                â”‚ â”‚â”‚
â”‚  â”‚  â”‚  - DevSecurityConfig / ProdSecurityConfig                        â”‚ â”‚â”‚
â”‚  â”‚  â”‚  - JpaUserDetailsService                                         â”‚ â”‚â”‚
â”‚  â”‚  â”‚  - Role-based access control                                     â”‚ â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                      CONTROLLER LAYER                                 â”‚â”‚
â”‚  â”‚                                                                        â”‚â”‚
â”‚  â”‚  GuestController    CashierController    KitchenController            â”‚â”‚
â”‚  â”‚  LoginController    DashboardController                               â”‚â”‚
â”‚  â”‚  Manager:                                                             â”‚â”‚
â”‚  â”‚    - CategoryController    - ProductController                        â”‚â”‚
â”‚  â”‚    - StaffController        - TableController                         â”‚â”‚
â”‚  â”‚    - VoucherController                                                â”‚â”‚
â”‚  â”‚                                                                        â”‚â”‚
â”‚  â”‚  Xá»­ lÃ½ HTTP Request â†’ Response (Synchronous)                          â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                              â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                      SERVICE LAYER                                     â”‚â”‚
â”‚  â”‚                                                                        â”‚â”‚
â”‚  â”‚  CategoryService    ProductService    StaffService                    â”‚â”‚
â”‚  â”‚  TableService       VoucherService    ShiftService                    â”‚â”‚
â”‚  â”‚  LoginService       OtpMailService                                    â”‚â”‚
â”‚  â”‚                                                                        â”‚â”‚
â”‚  â”‚  Business Logic & Validation                                          â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                              â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                      REPOSITORY LAYER                                  â”‚â”‚
â”‚  â”‚                                                                        â”‚â”‚
â”‚  â”‚  CategoryRepo    ProductRepo    StaffRepo    TableRepo                â”‚â”‚
â”‚  â”‚  VoucherRepo     ShiftRepo      StaffShiftRepo                        â”‚â”‚
â”‚  â”‚                                                                        â”‚â”‚
â”‚  â”‚  Spring Data JPA (CRUD Operations)                                    â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                              â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                      ENTITY LAYER                                      â”‚â”‚
â”‚  â”‚                                                                        â”‚â”‚
â”‚  â”‚  Category    Product    Staff    DiningTable    Voucher               â”‚â”‚
â”‚  â”‚  Order       OrderItem  Session  Shift          Membership            â”‚â”‚
â”‚  â”‚                                                                        â”‚â”‚
â”‚  â”‚  JPA Entities (ORM Mapping)                                           â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  SQL Server Database â”‚
                    â”‚                      â”‚
                    â”‚  Tables:             â”‚
                    â”‚  - staff             â”‚
                    â”‚  - product           â”‚
                    â”‚  - category          â”‚
                    â”‚  - dining_table      â”‚
                    â”‚  - order             â”‚
                    â”‚  - order_item        â”‚
                    â”‚  - voucher           â”‚
                    â”‚  - shift             â”‚
                    â”‚  - session           â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Äáº·c Ä‘iá»ƒm:**
- âœ… Kiáº¿n trÃºc 3-Layer: Controller â†’ Service â†’ Repository
- âœ… Communication: **Request-Response (Synchronous)**
- âœ… Client pháº£i refresh page hoáº·c polling Ä‘á»ƒ cáº­p nháº­t data
- âŒ KhÃ´ng cÃ³ real-time updates
- âŒ Kitchen/Cashier khÃ´ng nháº­n thÃ´ng bÃ¡o tá»©c thÃ¬ khi cÃ³ order má»›i

---

## ğŸš€ KIáº¾N TRÃšC Má»šI (Sau khi tÃ­ch há»£p WebSocket)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            CLIENT LAYER (Browser)                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Guest Page    â”‚  â”‚ Cashier Page   â”‚  â”‚ Kitchen Page   â”‚  â”‚ Manager Page   â”‚   â”‚
â”‚  â”‚                â”‚  â”‚                â”‚  â”‚                â”‚  â”‚                â”‚   â”‚
â”‚  â”‚  - Thymeleaf   â”‚  â”‚  - Thymeleaf   â”‚  â”‚  - Thymeleaf   â”‚  â”‚  - Thymeleaf   â”‚   â”‚
â”‚  â”‚  - Static HTML â”‚  â”‚  - WebSocket JSâ”‚  â”‚  - WebSocket JSâ”‚  â”‚  - WebSocket JSâ”‚   â”‚
â”‚  â”‚                â”‚  â”‚  - STOMP Clientâ”‚  â”‚  - STOMP Clientâ”‚  â”‚  - STOMP Clientâ”‚   â”‚
â”‚  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜   â”‚
â”‚      â”‚                   â”‚        â”‚          â”‚        â”‚          â”‚        â”‚       â”‚
â””â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                   â”‚        â”‚          â”‚        â”‚          â”‚        â”‚
       â”‚ HTTP              â”‚ HTTP   â”‚WS        â”‚ HTTP   â”‚WS        â”‚ HTTP   â”‚WS
       â”‚ Request           â”‚Request â”‚          â”‚Request â”‚          â”‚Request â”‚
       â–¼                   â–¼        â–¼          â–¼        â–¼          â–¼        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         SPRING BOOT APPLICATION                                      â”‚
â”‚                                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                            SECURITY LAYER                                       â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚
â”‚  â”‚  â”‚  Spring Security                                                          â”‚ â”‚â”‚
â”‚  â”‚  â”‚  - HTTP Security (Controllers)                                            â”‚ â”‚â”‚
â”‚  â”‚  â”‚  - WebSocket Security (STOMP endpoints)  â—„â”€â”€â”€â”€ Má»šI THÃŠM                  â”‚ â”‚â”‚
â”‚  â”‚  â”‚  - Role-based channel authorization      â—„â”€â”€â”€â”€ Má»šI THÃŠM                  â”‚ â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                     COMMUNICATION LAYER (2 Protocols)                           â”‚â”‚
â”‚  â”‚                                                                                 â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚â”‚
â”‚  â”‚  â”‚   HTTP/HTTPS           â”‚      â”‚   WebSocket/STOMP  â—„â”€â”€â”€â”€ Má»šI THÃŠM     â”‚   â”‚â”‚
â”‚  â”‚  â”‚   (Traditional)        â”‚      â”‚   (Real-time)                          â”‚   â”‚â”‚
â”‚  â”‚  â”‚                        â”‚      â”‚                                        â”‚   â”‚â”‚
â”‚  â”‚  â”‚  - Page requests       â”‚      â”‚  - Persistent connection               â”‚   â”‚â”‚
â”‚  â”‚  â”‚  - Form submissions    â”‚      â”‚  - Bi-directional                      â”‚   â”‚â”‚
â”‚  â”‚  â”‚  - AJAX calls          â”‚      â”‚  - Push notifications                  â”‚   â”‚â”‚
â”‚  â”‚  â”‚  - File uploads        â”‚      â”‚  - Real-time updates                   â”‚   â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                    WEBSOCKET INFRASTRUCTURE  â—„â”€â”€â”€â”€ Má»šI THÃŠM                     â”‚â”‚
â”‚  â”‚                                                                                 â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚
â”‚  â”‚  â”‚  WebSocket Configuration                                                  â”‚ â”‚â”‚
â”‚  â”‚  â”‚  - WebSocketConfig                                                        â”‚ â”‚â”‚
â”‚  â”‚  â”‚  - Endpoint: /ws (SockJS)                                                 â”‚ â”‚â”‚
â”‚  â”‚  â”‚  - Message Broker: /topic, /queue                                        â”‚ â”‚â”‚
â”‚  â”‚  â”‚  - Application Prefix: /app                                              â”‚ â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚
â”‚  â”‚                                                                                 â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚
â”‚  â”‚  â”‚  STOMP Message Broker                                                     â”‚ â”‚â”‚
â”‚  â”‚  â”‚                                                                           â”‚ â”‚â”‚
â”‚  â”‚  â”‚  Topics (Broadcast):                                                      â”‚ â”‚â”‚
â”‚  â”‚  â”‚  â”œâ”€ /topic/kitchen   â†’ Notifications cho Kitchen staff                   â”‚ â”‚â”‚
â”‚  â”‚  â”‚  â”œâ”€ /topic/cashier   â†’ Notifications cho Cashier                         â”‚ â”‚â”‚
â”‚  â”‚  â”‚  â”œâ”€ /topic/manager   â†’ Notifications cho Manager                         â”‚ â”‚â”‚
â”‚  â”‚  â”‚  â””â”€ /topic/table/{tableId} â†’ Updates cho bÃ n cá»¥ thá»ƒ                     â”‚ â”‚â”‚
â”‚  â”‚  â”‚                                                                           â”‚ â”‚â”‚
â”‚  â”‚  â”‚  Queues (Point-to-Point):                                                 â”‚ â”‚â”‚
â”‚  â”‚  â”‚  â””â”€ /queue/staff/{staffId} â†’ Personal notifications                      â”‚ â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚
â”‚  â”‚                                                                                 â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚
â”‚  â”‚  â”‚  WebSocket Event Listener                                                 â”‚ â”‚â”‚
â”‚  â”‚  â”‚  - Session connect/disconnect tracking                                    â”‚ â”‚â”‚
â”‚  â”‚  â”‚  - Online staff management                                                â”‚ â”‚â”‚
â”‚  â”‚  â”‚  - Auto cleanup on disconnect                                             â”‚ â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                       CONTROLLER LAYER (Má»Ÿ rá»™ng)                                â”‚â”‚
â”‚  â”‚                                                                                 â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚
â”‚  â”‚  â”‚  HTTP Controllers      â”‚    â”‚  WebSocket Controllers  â—„â”€â”€â”€â”€ Má»šI THÃŠM     â”‚ â”‚â”‚
â”‚  â”‚  â”‚  (Existing)            â”‚    â”‚                                            â”‚ â”‚â”‚
â”‚  â”‚  â”‚                        â”‚    â”‚  - OrderNotificationController             â”‚ â”‚â”‚
â”‚  â”‚  â”‚  - GuestController     â”‚    â”‚    @MessageMapping("/order.create")        â”‚ â”‚â”‚
â”‚  â”‚  â”‚  - CashierController   â”‚    â”‚    @SendTo("/topic/kitchen")              â”‚ â”‚â”‚
â”‚  â”‚  â”‚  - KitchenController   â”‚    â”‚                                            â”‚ â”‚â”‚
â”‚  â”‚  â”‚  - Manager Controllers â”‚    â”‚  - TableStatusController                   â”‚ â”‚â”‚
â”‚  â”‚  â”‚  - LoginController     â”‚    â”‚    @MessageMapping("/table.update")        â”‚ â”‚â”‚
â”‚  â”‚  â”‚                        â”‚    â”‚    @SendTo("/topic/cashier")              â”‚ â”‚â”‚
â”‚  â”‚  â”‚  Return: Views/JSON    â”‚    â”‚                                            â”‚ â”‚â”‚
â”‚  â”‚  â”‚                        â”‚    â”‚  - StaffPresenceController                 â”‚ â”‚â”‚
â”‚  â”‚  â”‚                        â”‚    â”‚    Track online/offline status             â”‚ â”‚â”‚
â”‚  â”‚  â”‚                        â”‚    â”‚                                            â”‚ â”‚â”‚
â”‚  â”‚  â”‚                        â”‚    â”‚  Return: Real-time messages                â”‚ â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                       SERVICE LAYER (Má»Ÿ rá»™ng)                                   â”‚â”‚
â”‚  â”‚                                                                                 â”‚â”‚
â”‚  â”‚  Existing Services:                    New/Enhanced Services:                  â”‚â”‚
â”‚  â”‚  - CategoryService                     - OrderService (enhanced)               â”‚â”‚
â”‚  â”‚  - ProductService                        + sendOrderToKitchen()  â—„â”€ WebSocket â”‚â”‚
â”‚  â”‚  - StaffService                        - TableService (enhanced)               â”‚â”‚
â”‚  â”‚  - TableService                          + broadcastTableStatus() â—„â”€ WebSocketâ”‚â”‚
â”‚  â”‚  - VoucherService                      - NotificationService (NEW)             â”‚â”‚
â”‚  â”‚  - ShiftService                          + sendToStaff()                       â”‚â”‚
â”‚  â”‚  - LoginService                          + broadcastToRole()                   â”‚â”‚
â”‚  â”‚  - OtpMailService                                                              â”‚â”‚
â”‚  â”‚                                                                                 â”‚â”‚
â”‚  â”‚  Inject: SimpMessagingTemplate Ä‘á»ƒ gá»­i WebSocket messages  â—„â”€â”€â”€â”€ Má»šI THÃŠM      â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                      REPOSITORY & ENTITY LAYER (KhÃ´ng Ä‘á»•i)                      â”‚â”‚
â”‚  â”‚                                                                                 â”‚â”‚
â”‚  â”‚  Repository: CategoryRepo, ProductRepo, StaffRepo, OrderRepo...                â”‚â”‚
â”‚  â”‚  Entity: Category, Product, Staff, Order, OrderItem, DiningTable...            â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â–¼
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                       â”‚  SQL Server Database   â”‚
                       â”‚  (KhÃ´ng thay Ä‘á»•i)      â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ CÃC LUá»’NG HOáº T Äá»˜NG REAL-TIME

### 1ï¸âƒ£ LUá»’NG Táº O ORDER Má»šI (Guest â†’ Kitchen)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Guest   â”‚       â”‚ Cashier â”‚       â”‚ Backend  â”‚       â”‚  STOMP  â”‚       â”‚ Kitchen â”‚
â”‚ (Web)   â”‚       â”‚ (Web)   â”‚       â”‚ Service  â”‚       â”‚ Broker  â”‚       â”‚ (Web)   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚                 â”‚                 â”‚                  â”‚                 â”‚
     â”‚ 1. Chá»n mÃ³n,    â”‚                 â”‚                  â”‚                 â”‚
     â”‚    Submit order â”‚                 â”‚                  â”‚                 â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚                  â”‚                 â”‚
     â”‚                 â”‚                 â”‚                  â”‚                 â”‚
     â”‚                 â”‚ 2. HTTP POST    â”‚                  â”‚                 â”‚
     â”‚                 â”‚   /order/create â”‚                  â”‚                 â”‚
     â”‚                 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                  â”‚                 â”‚
     â”‚                 â”‚                 â”‚                  â”‚                 â”‚
     â”‚                 â”‚                 â”‚ 3. Save to DB    â”‚                 â”‚
     â”‚                 â”‚                 â”‚    (OrderService)â”‚                 â”‚
     â”‚                 â”‚                 â”‚                  â”‚                 â”‚
     â”‚                 â”‚                 â”‚ 4. Send WebSocketâ”‚                 â”‚
     â”‚                 â”‚                 â”‚    message       â”‚                 â”‚
     â”‚                 â”‚                 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
     â”‚                 â”‚                 â”‚  /topic/kitchen  â”‚                 â”‚
     â”‚                 â”‚                 â”‚                  â”‚                 â”‚
     â”‚                 â”‚                 â”‚                  â”‚ 5. Broadcast    â”‚
     â”‚                 â”‚                 â”‚                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚                 â”‚                 â”‚                  â”‚ "New Order #123"â”‚
     â”‚                 â”‚                 â”‚                  â”‚                 â”‚
     â”‚                 â”‚                 â”‚                  â”‚ 6. Popup hiá»‡n   â”‚
     â”‚                 â”‚                 â”‚                  â”‚    ngay láº­p tá»©c â”‚
     â”‚                 â”‚                 â”‚                  â”‚    (khÃ´ng F5)   â”‚
```

### 2ï¸âƒ£ LUá»’NG Cáº¬P NHáº¬T TRáº NG THÃI BÃ€N (Cashier â†” Manager)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Cashier â”‚       â”‚ Backend  â”‚       â”‚  STOMP  â”‚       â”‚ Manager â”‚
â”‚         â”‚       â”‚          â”‚       â”‚ Broker  â”‚       â”‚         â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚                 â”‚                  â”‚                 â”‚
     â”‚ 1. Click "BÃ n 5â”‚                  â”‚                 â”‚
     â”‚    Ä‘ang phá»¥c vá»¥"                  â”‚                 â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                  â”‚                 â”‚
     â”‚                 â”‚                  â”‚                 â”‚
     â”‚                 â”‚ 2. Update DB     â”‚                 â”‚
     â”‚                 â”‚   (TableService) â”‚                 â”‚
     â”‚                 â”‚                  â”‚                 â”‚
     â”‚                 â”‚ 3. Broadcast     â”‚                 â”‚
     â”‚                 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
     â”‚                 â”‚ /topic/table/5   â”‚                 â”‚
     â”‚                 â”‚                  â”‚                 â”‚
     â”‚                 â”‚                  â”‚ 4. Real-time    â”‚
     â”‚ 5. Cáº­p nháº­t UI  â”‚                  â”‚    update       â”‚
     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚ (mÃ u bÃ n Ä‘á»•i)   â”‚                  â”‚ (mÃ u bÃ n Ä‘á»•i)   â”‚
```

### 3ï¸âƒ£ LUá»’NG THÃ”NG BÃO CA LÃ€M VIá»†C (Manager â†’ Staff)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Manager â”‚       â”‚ Backend  â”‚       â”‚  STOMP  â”‚       â”‚ All Staff    â”‚
â”‚         â”‚       â”‚          â”‚       â”‚ Broker  â”‚       â”‚ (Online)     â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                 â”‚                  â”‚                   â”‚
     â”‚ 1. Táº¡o ca má»›i   â”‚                  â”‚                   â”‚
     â”‚    "SÃ¡ng 8-12"  â”‚                  â”‚                   â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                  â”‚                   â”‚
     â”‚                 â”‚                  â”‚                   â”‚
     â”‚                 â”‚ 2. Save shift    â”‚                   â”‚
     â”‚                 â”‚   (ShiftService) â”‚                   â”‚
     â”‚                 â”‚                  â”‚                   â”‚
     â”‚                 â”‚ 3. Broadcast     â”‚                   â”‚
     â”‚                 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                   â”‚
     â”‚                 â”‚ /topic/staff     â”‚                   â”‚
     â”‚                 â”‚                  â”‚                   â”‚
     â”‚                 â”‚                  â”‚ 4. Push notify    â”‚
     â”‚                 â”‚                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚                 â”‚                  â”‚ "Ca má»›i: SÃ¡ng 8-12"
     â”‚                 â”‚                  â”‚                   â”‚
     â”‚                 â”‚                  â”‚ 5. Toast/Alert    â”‚
     â”‚                 â”‚                  â”‚    hiá»ƒn thá»‹       â”‚
```


## ğŸ¯ CÃC COMPONENT Má»šI Cáº¦N THÃŠM

### Backend:

```
src/main/java/.../
â”œâ”€â”€ config/
â”‚   â””â”€â”€ WebSocketConfig.java                â—„â”€â”€â”€â”€ Cáº¥u hÃ¬nh WebSocket
â”‚
â”œâ”€â”€ controller/websocket/
â”‚   â”œâ”€â”€ OrderNotificationController.java    â—„â”€â”€â”€â”€ Order real-time
â”‚   â”œâ”€â”€ TableStatusController.java          â—„â”€â”€â”€â”€ Table updates
â”‚   â”œâ”€â”€ StaffPresenceController.java        â—„â”€â”€â”€â”€ Staff online/offline
â”‚   â””â”€â”€ ChatController.java                 â—„â”€â”€â”€â”€ Staff chat (optional)
â”‚
â”œâ”€â”€ dto/websocket/
â”‚   â”œâ”€â”€ OrderNotificationDTO.java           â—„â”€â”€â”€â”€ Data cho notifications
â”‚   â”œâ”€â”€ TableStatusUpdateDTO.java
â”‚   â””â”€â”€ StaffPresenceDTO.java
â”‚
â”œâ”€â”€ service/
â”‚   â””â”€â”€ NotificationService.java            â—„â”€â”€â”€â”€ Service gá»­i WebSocket
â”‚       (inject SimpMessagingTemplate)
â”‚
â””â”€â”€ listener/
    â””â”€â”€ WebSocketEventListener.java         â—„â”€â”€â”€â”€ Track connections
```

### Frontend:

```
src/main/resources/
â”œâ”€â”€ static/
â”‚   â””â”€â”€ js/
â”‚       â”œâ”€â”€ websocket-client.js             â—„â”€â”€â”€â”€ STOMP client setup
â”‚       â”œâ”€â”€ kitchen-notifications.js        â—„â”€â”€â”€â”€ Kitchen-specific
â”‚       â”œâ”€â”€ cashier-notifications.js        â—„â”€â”€â”€â”€ Cashier-specific
â”‚       â””â”€â”€ table-realtime-updates.js       â—„â”€â”€â”€â”€ Real-time table UI
â”‚
â””â”€â”€ templates/
    â”œâ”€â”€ kitchen-page/
    â”‚   â””â”€â”€ kitchen.html                    â—„â”€â”€â”€â”€ ThÃªm WebSocket script
    â”œâ”€â”€ cashier-page/
    â”‚   â””â”€â”€ cashier.html                    â—„â”€â”€â”€â”€ ThÃªm WebSocket script
    â””â”€â”€ admin_page/
        â””â”€â”€ dashboard.html                  â—„â”€â”€â”€â”€ Live analytics
```

---

## ğŸ” Báº¢O Máº¬T WEBSOCKET

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              WebSocket Security Configuration               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Channel Authorization:                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  /topic/kitchen    â†’ ROLE_KITCHEN, ROLE_MANAGER       â”‚ â”‚
â”‚  â”‚  /topic/cashier    â†’ ROLE_CASHIER, ROLE_MANAGER       â”‚ â”‚
â”‚  â”‚  /topic/manager    â†’ ROLE_MANAGER                     â”‚ â”‚
â”‚  â”‚  /queue/staff/{id} â†’ Owner only (CSRF token check)    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚  Authentication:                                            â”‚
â”‚  - DÃ¹ng chung session vá»›i HTTP (Spring Security)           â”‚
â”‚  - WebSocket handshake check authentication                â”‚
â”‚  - StompHeaderAccessor Ä‘á»ƒ láº¥y Principal                    â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’¡ Tá»”NG Káº¾T

### Kiáº¿n trÃºc má»›i cÃ³ 2 táº§ng giao tiáº¿p song song:

1. **HTTP/HTTPS Layer** (Traditional)
   - CRUD operations
   - Page navigation
   - Form submissions
   - File uploads

2. **WebSocket Layer** (Real-time)
   - Order notifications
   - Table status updates
   - Staff presence
   - Live analytics
   - Chat (optional)

