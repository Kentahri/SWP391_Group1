<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Cashier Dashboard - Table Management</title>
	<link rel="stylesheet" th:href="@{/css/cashier-dashboard.css}">
</head>
<body>
<div class="dashboard-container">
	<!-- Top bar -->
	<header class="topbar">
		<div class="brand">ğŸ• PizzarIO</div>
		<div class="actions">
			<button class="btn action-purple" type="button">Táº¡o má»›i Ä‘Æ¡n hÃ ng</button>
			<button class="btn action-green" type="button">Xem lá»‹ch sá»­ hÃ³a Ä‘Æ¡n</button>
			<form th:action="@{/logout}" method="post">
				<input type="hidden"
				       th:if="${_csrf != null}"
				       th:name="${_csrf.parameterName}"
				       th:value="${_csrf.token}" />
				<button type="submit" class="btn-logout">Logout</button>
			</form>
		</div>
	</header>
	<div class="horizontal-divider"></div>
	
	<div class="layout">
		<!-- Left: Table manager -->
		<section class="panel left">
			<div class="section-title">Quáº£n lÃ½ bÃ n</div>
			<div class="panel-header">
				<span class="icon">ğŸª‘</span>
				<span class="title">Table map</span>
			</div>
			
			<div class="table-grid" id="table-grid">
				<div th:each="table : ${tables}"
				     th:id="'table-' + ${table.id}"
				     th:class="'table-card ' + ${table.tableStatus.toString().toLowerCase()}"
				     th:onclick="'handleTableClick(' + ${table.id} + ')'"
				     th:attr="data-id=${table.id},
				              data-status=${table.tableStatus},
				              data-capacity=${table.capacity}
				              ">
					<div class="table-dot"
					     th:classappend="${table.tableStatus.toString().toLowerCase() == 'waiting_payment' ? ' show' : ''}"></div>
					<div class="table-number">BÃ n [[${table.id}]]</div>
					<div class="table-status-text"
					     th:text="${table.tableStatus == 'AVAILABLE' ? 'Trá»‘ng' : (table.tableStatus == 'OCCUPIED' ? 'CÃ³ khÃ¡ch' : (table.tableStatus == 'WAITING_PAYMENT' ? 'Chá» thanh toÃ¡n' : 'ÄÃ£ Ä‘áº·t trÆ°á»›c'))}">
						Trá»‘ng
					</div>
					<div class="table-note" th:if="${table.tableStatus == 'WAITING_PAYMENT'}">Tiá»n máº·t</div>
					<div class="table-capacity" th:if="${table.tableStatus == 'RESERVED'}">[[${table.capacity}]] ngÆ°á»i
					</div>
					<div class="table-actions" th:if="${table.tableStatus == 'WAITING_PAYMENT'}">
						<button class="btn small" th:onclick="'releaseTable(' + ${table.id} + ', event)'">Giáº£i phÃ³ng
						</button>
					</div>
				</div>
			</div>
			
			<div class="legend">
				<div class="legend-title">ChÃº thÃ­ch:</div>
				<div class="legend-items">
					<div class="legend-item"><span class="box avail"></span><span>BÃ n trá»‘ng</span></div>
					<div class="legend-item"><span class="box occ"></span><span>Äang cÃ³ khÃ¡ch</span></div>
					<div class="legend-item"><span class="box wait"></span><span>Chá» thanh toÃ¡n</span></div>
					<div class="legend-item"><span class="box res"></span><span>ÄÃ£ Ä‘áº·t trÆ°á»›c</span></div>
				</div>
			</div>
		</section>
		
		<!-- Right: Table details -->
        <section class="panel right">
            <div class="section-title">ÄÆ¡n bÃ n chi tiáº¿t</div>
            <div id="table-detail" class="table-detail">
                <div class="placeholder">Chá»n 1 bÃ n Ä‘á»ƒ xem chi tiáº¿t</div>
            </div>
		</section>
	</div>
</div>

<div class="toast-container" id="toast-container"></div>

<div>TÃªn: <p th:text="${name}"></p></div>

<script src="https://cdn.jsdelivr.net/npm/sockjs-client@1.6.1/dist/sockjs.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/stompjs@2.3.3/lib/stomp.min.js"></script>
<script th:src="@{/js/cashier-websocket.js}"></script>
</body>
</html>


