<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Hóa đơn thanh toán - PizzarlO</title>
    <link rel="stylesheet" th:href="@{/css/guest_page/invoice.css}" />
  </head>
  <body>
    <div class="invoice-container">
      <div class="receipt">
        <!-- Receipt Header -->
        <div class="receipt-header">
          <div class="receipt-title">HÓA ĐƠN THANH TOÁN</div>
          <div class="restaurant-name">PizzarlO</div>
          <div class="restaurant-address">KM29 - ĐL. Thăng Long</div>
          <div class="restaurant-phone">ĐT: 0123456678-0987654321</div>
          <div class="separator">*****************</div>
        </div>

        <!-- Transaction Information -->
        <div class="transaction-info">
          <div class="date-time">
            <span
              th:text="${#temporals.format(payment.createdAt, 'dd-MM-yyyy')}"
              >20-09-2025</span
            >
            <span th:text="${#temporals.format(payment.createdAt, 'HH:mm:ss')}"
              >11:02:37</span
            >
          </div>
          <div class="customer-info">
            Khách hàng:
            <span
              th:text="${payment.customerName ?: (membership != null ? membership.name : 'Khách vãng lai')}"
              >Phan Văn A</span
            >
          </div>
          <div class="table-info" th:if="${payment.tableNumber != null}">
            Bàn số: <span th:text="${payment.tableNumber}">05</span>
          </div>
          <div class="staff-info" th:if="${staff != null}">
            Nhân viên: <span th:text="${staff.name}">Nguyễn Văn A</span>
          </div>
        </div>

        <!-- Items Header -->
        <div class="items-header">
          <div>Tên món</div>
          <div>Số lượng</div>
          <div>Thành tiền</div>
        </div>

        <!-- Order Items -->
        <div th:each="item : ${orderItems}" class="order-item">
          <div
            th:text="${item.productSize.product.name} + ' (' + ${item.productSize.size.sizeName} + ')'"
          ></div>
          <div th:text="${item.quantity}"></div>
          <div
            th:text="${#numbers.formatDecimal(item.totalPrice, 0, 'COMMA', 0, 'POINT')}"
          >
            245,000
          </div>
        </div>

        <!-- Summary Section -->
        <div class="summary-section">
          <div class="summary-row">
            <span>Tạm tính:</span>
            <span
              th:text="${#numbers.formatDecimal(originalTotal, 0, 'COMMA', 0, 'POINT')}"
              >420,000</span
            >
          </div>
          <div class="summary-row">
            <span>Giảm giá:</span>
            <span
              th:text="${discountAmount != null && discountAmount > 0 ? '-' + #numbers.formatDecimal(discountAmount, 0, 'COMMA', 0, 'POINT') : '0'}"
              >-84,000</span
            >
          </div>
          <div class="summary-row">
            <span>Thuế (10%):</span>
            <span
              th:text="${#numbers.formatDecimal(taxAmount, 0, 'COMMA', 0, 'POINT')}"
              >33,600</span
            >
          </div>
          <div class="summary-row total-row">
            <span>Tổng cộng:</span>
            <span
              th:text="${#numbers.formatDecimal(totalWithTax, 0, 'COMMA', 0, 'POINT')}"
              >369,600</span
            >
          </div>
        </div>

        <!-- Footer -->
        <div class="footer">
          <div class="thank-you">
            PizzarlO xin cảm ơn và hẹn gặp lại quý khách !
          </div>
        </div>
      </div>

      <!-- Print Button -->
      <div class="print-actions">
        <button class="btn-print" onclick="window.print()">In hóa đơn</button>
        <button class="btn-close" onclick="window.close()">Đóng</button>
      </div>
    </div>
  </body>
</html>
