<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Qu·∫£n l√Ω Danh m·ª•c ‚Ä¢ Admin Dashboard</title>
    <link rel="stylesheet" th:href="@{/css/admin_page/styles.css}" />
    <link rel="stylesheet" th:href="@{/css/admin_page/category-list.css}" />
  </head>
  <body>
    <div class="app">
      <div th:insert="~{fragments/sidebar :: sidebar('categories')}"></div>

      <div class="main-content">
        <div class="page-header">
          <div class="header-content">
            <h1>Qu·∫£n l√Ω Danh m·ª•c</h1>
            <p class="subtitle">Th√™m, s·ª≠a, ·∫©n/hi·ªán c√°c danh m·ª•c s·∫£n ph·∫©m</p>
          </div>

          <!-- Thanh t√¨m ki·∫øm -->
          <div class="search-container">
            <input
              type="text"
              id="categorySearch"
              class="search-input"
              placeholder="T√¨m ki·∫øm danh m·ª•c..."
              autocomplete="off"
            />
            <span class="search-icon">üîç</span>
          </div>

          <a th:href="@{/manager/categories/new}" class="btn-add-category">
            <span>+</span> Th√™m danh m·ª•c
          </a>
        </div>

        <div class="category-table-container">
          <!-- Modal -->
          <div id="categoryModal" class="modal">
            <div class="modal-content">
              <div class="modal-header">
                <h2 id="modalTitle">Th√™m danh m·ª•c m·ªõi</h2>
                <span class="close" onclick="closeModal()">&times;</span>
              </div>

              <form id="categoryForm" method="post" th:object="${categoryForm}">
                <input type="hidden" th:field="*{id}" />

                <div class="mb-3">
                  <label>T√™n danh m·ª•c</label>
                  <input type="text" th:field="*{name}" required />
                </div>

                <div class="mb-3">
                  <label>M√¥ t·∫£</label>
                  <textarea th:field="*{description}" rows="3"></textarea>
                </div>

                <div class="form-check mb-3">
                  <input
                    type="checkbox"
                    th:field="*{active}"
                    id="activeCheck"
                  />
                  <label for="activeCheck">K√≠ch ho·∫°t</label>
                </div>

                <div class="modal-footer">
                  <button type="submit" class="btn btn-primary">L∆∞u</button>
                  <button
                    type="button"
                    class="btn btn-secondary"
                    onclick="closeModal()"
                  >
                    H·ªßy
                  </button>
                </div>
              </form>
            </div>
          </div>

          <!-- Table -->
          <table class="table">
            <thead>
              <tr>
                <th>ID</th>
                <th>T√™n</th>
                <th>M√¥ t·∫£</th>
                <th>Tr·∫°ng th√°i</th>
                <th>H√†nh ƒë·ªông</th>
              </tr>
            </thead>
            <tbody>
              <tr
                th:each="cat : ${categories}"
                th:classappend="${!cat.active} ? 'inactive' : ''"
              >
                <td th:text="${cat.id}"></td>
                <td th:text="${cat.name}"></td>
                <td th:text="${cat.description}"></td>
                <td>
                  <span
                    class="badge"
                    th:classappend="${cat.active} ? 'badge-active' : 'badge-inactive'"
                  >
                    <span th:text="${cat.active} ? 'C√≥ s·∫µn' : 'ƒê√£ ·∫©n'"></span>
                  </span>
                </td>
                <td>
                  <div class="action-buttons">
                    <a
                      th:href="@{/manager/categories/edit/{id}(id=${cat.id})}"
                      class="btn-icon btn-edit"
                      title="S·ª≠a"
                    >
                      S·ª≠a
                    </a>
                    <form
                      th:action="@{/manager/categories/toggle/{id}(id=${cat.id})}"
                      method="post"
                      class="inline-form"
                      onsubmit="return confirm('B·∫°n c√≥ ch·∫Øc mu·ªën thay ƒë·ªïi tr·∫°ng th√°i?')"
                    >
                      <button
                        type="submit"
                        class="btn-icon"
                        th:classappend="${cat.active} ? 'btn-hide' : 'btn-show'"
                        th:title="${cat.active} ? '·∫®n' : 'Hi·ªán'"
                      >
                        <span th:if="${cat.active}">·∫®n</span>
                        <span th:unless="${cat.active}">Hi·ªán</span>
                      </button>
                    </form>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <script th:inline="javascript">
      window.openModalFlag = /*[[${openModal}]]*/ null;
    </script>
    <script th:src="@{/js/admin/category-list.js}"></script>
  </body>
</html>
