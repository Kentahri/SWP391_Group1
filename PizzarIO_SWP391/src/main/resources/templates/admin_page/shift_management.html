<!doctype html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Ca l√†m vi·ªác ‚Ä¢ Admin Dashboard</title>
    <link rel="stylesheet" th:href="@{/css/styles.css}">
    <!-- CSS ri√™ng cho modal form -->
    <link rel="stylesheet" th:href="@{/css/shifts-form.css}">
</head>
<body>
<div class="app">
    <!-- SIDEBAR -->
    <aside class="sidebar">
        <div class="brand">
            <div class="logo">üçï</div>
            <div class="brand-text"><strong>Admin</strong><span>Qu·∫£n l√Ω nh√† h√†ng</span></div>
        </div>
        <nav class="nav">
            <a class="nav-link" th:href="@{/admin/analytics}"> S·ªë li·ªáu ph√¢n t√≠ch</a>
            <a class="nav-link" th:href="@{/admin/products}"> S·∫£n ph·∫©m</a>
            <a class="nav-link" th:href="@{/admin/categories}"> Danh m·ª•c</a>
            <a class="nav-link" th:href="@{/admin/vouchers}"> Voucher</a>
            <a class="nav-link" th:href="@{/admin/staff}"> Nh√¢n vi√™n</a>
            <a class="nav-link active" th:href="@{/admin/shifts}"> Ca l√†m vi·ªác</a>
            <a class="nav-link" th:href="@{/admin/complaints}"> Khi·∫øu n·∫°i</a>
            <a class="nav-link" th:href="@{/admin/inventory}"> Kho h√†ng</a>
            <a class="nav-link" th:href="@{/admin/settings}"> C√†i ƒë·∫∑t</a>
        </nav>
    </aside>

    <!-- MAIN -->
    <main class="main">
        <!-- Title + primary CTA -->
        <header class="page-header">
            <div>
                <h1>Qu·∫£n l√Ω ca l√†m vi·ªác</h1>
                <p class="muted">Ph√¢n ca v√† theo d√µi th·ªùi gian l√†m vi·ªác</p>
            </div>
            <!-- M·ªü modal t·∫°o ca (no JS) -->
            <label for="openShiftModal" class="btn-primary" id="btnCreateShift">Ôºã Th√™m ca l√†m vi·ªác</label>
        </header>

        <!-- KPI (pastel) -->
        <section class="kpi-ribbon">
            <article class="kpi-card tone-blue">
                <div class="kpi-meta">
                    <div class="kpi-label">T·ªïng ca l√†m vi·ªác</div>
                    <!-- TODO bind: t·ªïng s·ªë ca -->
                    <div class="kpi-value" id="kpiTotalShifts">‚Äî</div>
                </div>
            </article>
            <article class="kpi-card tone-green">
                <div class="kpi-meta">
                    <div class="kpi-label">T·ªïng gi·ªù l√†m</div>
                    <!-- TODO bind: t·ªïng gi·ªù -->
                    <div class="kpi-value" id="kpiTotalHours">‚Äî</div>
                </div>
            </article>
            <article class="kpi-card tone-purple">
                <div class="kpi-meta">
                    <div class="kpi-label">T·ªïng l∆∞∆°ng</div>
                    <!-- TODO bind: t·ªïng l∆∞∆°ng -->
                    <div class="kpi-value" id="kpiTotalPayroll">‚Äî</div>
                </div>
            </article>
            <article class="kpi-card tone-orange">
                <div class="kpi-meta">
                    <div class="kpi-label">Ca ho√†n th√†nh</div>
                    <!-- TODO bind: completed/total -->
                    <div class="kpi-value" id="kpiCompletedRatio">‚Äî</div>
                </div>
            </article>
        </section>

        <!-- Toolbar: l·ªãch + filter -->
        <section class="card toolbar toolbar-soft">
            <div class="toolbar-left">
                <!-- TODO action: v·ªÅ tu·∫ßn tr∆∞·ªõc -->
                <button class="btn-ghost" id="btnPrevWeek" type="button">‚óÄ Tu·∫ßn tr∆∞·ªõc</button>
            </div>
            <div class="toolbar-center">
                <!-- TODO bind: d·∫£i ng√†y tu·∫ßn -->
                <div class="toolbar-title" id="weekRange">‚Äî/‚Äî/‚Äî ‚Äì ‚Äî/‚Äî/‚Äî</div>
                <div class="muted small">Tu·∫ßn hi·ªán t·∫°i</div>
            </div>
            <div class="toolbar-right">
                <!-- TODO: b·ªô l·ªçc nh√¢n vi√™n -->
                <button class="chip" id="filterStaff" type="button">T·∫•t c·∫£ nh√¢n vi√™n ‚ñæ</button>
                <!-- TODO: b·ªô l·ªçc lo·∫°i ca -->
                <button class="chip" id="filterShiftType" type="button">T·∫•t c·∫£ ca ‚ñæ</button>
                <!-- TODO action: tu·∫ßn sau -->
                <button class="btn-ghost" id="btnNextWeek" type="button">Tu·∫ßn sau ‚ñ∂</button>
            </div>
        </section>

        <!-- L·ªãch 7 c·ªôt -->
        <section class="calendar card">
            <!-- Day headers -->
            <div class="calendar-days">
                <!-- TODO bind: t√™n + ng√†y s·ªë -->
                <div class="day-pill">CN <span id="d0" class="muted">‚Äî</span></div>
                <div class="day-pill">T2 <span id="d1" class="muted">‚Äî</span></div>
                <div class="day-pill">T3 <span id="d2" class="muted">‚Äî</span></div>
                <div class="day-pill">T4 <span id="d3" class="muted">‚Äî</span></div>
                <div class="day-pill">T5 <span id="d4" class="muted">‚Äî</span></div>
                <div class="day-pill">T6 <span id="d5" class="muted">‚Äî</span></div>
                <div class="day-pill">T7 <span id="d6" class="muted">‚Äî</span></div>
            </div>

            <!-- Grid columns -->
            <div class="calendar-grid">
                <!-- M·ªói c·ªôt l√† 1 ng√†y, backend loop ca v√† append .shift -->
                <div class="day-col" id="col-0"><!-- TODO: loop shifts day 0 --></div>
                <div class="day-col" id="col-1"><!-- TODO: loop shifts day 1 --></div>
                <div class="day-col" id="col-2"><!-- TODO: loop shifts day 2 --></div>
                <div class="day-col" id="col-3"><!-- TODO: loop shifts day 3 --></div>
                <div class="day-col" id="col-4"><!-- TODO: loop shifts day 4 --></div>
                <div class="day-col" id="col-5"><!-- TODO: loop shifts day 5 --></div>
                <div class="day-col" id="col-6"><!-- TODO: loop shifts day 6 --></div>
            </div>

            <!-- M·∫™U th·∫ª ca (kh√¥ng render): d√πng ƒë·ªÉ tham kh·∫£o c·∫•u tr√∫c khi backend render -->
            <template id="shiftSample">
                <article class="shift tone-morning">
                    <div class="shift-head">
                        <span class="shift-type">S√°ng</span>
                        <span class="shift-actions">‚úèÔ∏è üóëÔ∏è</span>
                    </div>
                    <div class="shift-staff">T√™n nh√¢n vi√™n</div>
                    <div class="shift-time">06:00 ‚Äì 14:00</div>
                    <div class="shift-foot">
                        <span class="badge done">Ho√†n th√†nh</span>
                        <span class="pay">320.000ƒë</span>
                    </div>
                </article>
            </template>
            <!-- TODO Backend: khi render server-side, t·∫°o <article class="shift ..."> t∆∞∆°ng t·ª± v√† ch√®n v√†o #col-0..6 -->
        </section>

        <!-- ===== Modal Th√™m ca (no JS, toggle b·∫±ng checkbox) ===== -->
        <input type="checkbox" id="openShiftModal" class="modal-toggle" hidden>

        <div class="modal" aria-hidden="true">
            <label class="modal-backdrop" for="openShiftModal"></label>

            <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="shiftModalTitle">
                <div class="modal-head">
                    <h3 id="shiftModalTitle">Th√™m ca l√†m vi·ªác m·ªõi</h3>
                    <label for="openShiftModal" class="modal-close" aria-label="ƒê√≥ng">‚úï</label>
                </div>

                <!-- TODO backend: ƒë·ªïi th:action t·ªõi endpoint t·∫°o ca -->
                <form class="simple-form" th:action="@{/admin/shifts}" method="post">
                    <!-- TODO: b·∫≠t CSRF n·∫øu d√πng Spring Security -->
                    <!-- <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/> -->

                    <div class="form-row">
                        <div class="form-field">
                            <label for="fDate">Ng√†y</label>
                            <!-- TODO bind/validate: LocalDate yyyy-MM-dd -->
                            <input id="fDate" name="date" type="date" required>
                        </div>

                        <div class="form-field">
                            <label for="fType">Lo·∫°i ca</label>
                            <!-- TODO backend: loop option lo·∫°i ca (S√ÅNG/CHI·ªÄU/T·ªêI) -->
                            <select id="fType" name="shiftType" required>
                                <option value="" selected disabled>Ch·ªçn ca</option>
                                <option value="MORNING">S√°ng</option>
                                <option value="AFTERNOON">Chi·ªÅu</option>
                                <option value="EVENING">T·ªëi</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-field">
                            <label for="fStart">Gi·ªù b·∫Øt ƒë·∫ßu</label>
                            <!-- TODO bind: LocalTime HH:mm -->
                            <input id="fStart" name="startTime" type="time" required>
                        </div>
                        <div class="form-field">
                            <label for="fEnd">Gi·ªù k·∫øt th√∫c</label>
                            <!-- TODO validate: end > start -->
                            <input id="fEnd" name="endTime" type="time" required>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-field">
                            <label for="fStaff">Nh√¢n vi√™n</label>
                            <!-- TODO backend: th:each danh s√°ch nh√¢n vi√™n -->
                            <select id="fStaff" name="staffId" required>
                                <option value="" selected disabled>Ch·ªçn nh√¢n vi√™n</option>
                                <!-- <option th:each="s : ${staffList}" th:value="${s.id}" th:text="${s.fullName}"></option> -->
                            </select>
                        </div>

                        <div class="form-field">
                            <label for="fWage">L∆∞∆°ng theo gi·ªù (VND)</label>
                            <!-- TODO default theo nh√¢n vi√™n/ca; backend ki·ªÉm tra s·ªë h·ª£p l·ªá -->
                            <input id="fWage" name="hourlyWage" type="number" min="0" step="1000" placeholder="35000" required>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn-primary" id="btnSubmitShift">Th√™m ca</button>
                        <!-- ƒê√≥ng modal kh√¥ng submit -->
                        <label for="openShiftModal" class="btn-ghost">H·ªßy</label>
                    </div>

                    <!-- TODO: hi·ªÉn th·ªã l·ªói validate c·ªßa server -->
                    <!-- <p class="form-error" th:if="${#fields.hasErrors('*')}" th:text="${#fields.errors('*')}"></p> -->
                </form>
            </div>
        </div>
        <!-- ===== /Modal ===== -->

    </main>
</div>
</body>
</html>
